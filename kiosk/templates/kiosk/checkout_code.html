{% extends 'kiosk/base.html' %}

{% block title %}{% if lang == 'es' %}Salir - Ingrese Código{% else %}Check Out - Enter Code{% endif %}{% endblock %}

{% block content %}
<h1>{% if lang == 'es' %}Ingrese Su Código{% else %}Enter Your Code{% endif %}</h1>

{% if error %}
<div class="error">{{ error }}</div>
{% endif %}

<form method="post">
    {% csrf_token %}

    <label for="code">{% if lang == 'es' %}Código de Registro{% else %}Check-In Code{% endif %}</label>
    <input type="tel" id="code" name="code" required
           autocomplete="off" inputmode="numeric"
           placeholder="____-__" maxlength="7"
           style="font-size: 32px; text-align: center; letter-spacing: 4px;">

    <button type="submit" class="btn btn-success">
        {% if lang == 'es' %}CONTINUAR{% else %}CONTINUE{% endif %}
    </button>
</form>

<a href="{% url 'kiosk:menu' %}" class="back-link">← {% if lang == 'es' %}Volver{% else %}Back{% endif %}</a>

<script>
const codeInput = document.getElementById('code');

codeInput.addEventListener('input', function(e) {
    // Strip non-digits
    let digits = this.value.replace(/\D/g, '');

    // Limit to 6 digits
    digits = digits.substring(0, 6);

    // Format as XXXX-XX
    if (digits.length > 4) {
        this.value = digits.substring(0, 4) + '-' + digits.substring(4);
    } else {
        this.value = digits;
    }
});

// Focus on load
codeInput.focus();
</script>
{% endblock %}
