{% extends 'kiosk/base.html' %}

{% block title %}Check Out - Enter Code{% endblock %}

{% block content %}
<h1>Enter Your Code</h1>

{% if error %}
<div class="error">{{ error }}</div>
{% endif %}

<form method="post">
    {% csrf_token %}

    <label for="code">Check-In Code</label>
    <input type="tel" id="code" name="code" required
           autocomplete="off" inputmode="numeric"
           placeholder="____-__" maxlength="7"
           style="font-size: 32px; text-align: center; letter-spacing: 4px;">

    <button type="submit" class="btn btn-success">CONTINUE</button>
</form>

<a href="{% url 'kiosk:home' %}" class="back-link">‚Üê Back</a>

<script>
const codeInput = document.getElementById('code');

codeInput.addEventListener('input', function(e) {
    // Strip non-digits
    let digits = this.value.replace(/\D/g, '');

    // Limit to 6 digits
    digits = digits.substring(0, 6);

    // Format as XXXX-XX
    if (digits.length > 4) {
        this.value = digits.substring(0, 4) + '-' + digits.substring(4);
    } else {
        this.value = digits;
    }
});

// Focus on load
codeInput.focus();
</script>
{% endblock %}
